name: Deploy Development

on:
  push:
    branches: [ develop ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸš€ Deploy to DEV Server
      uses: appleboy/ssh-action@master
      with:
        host: ${{ secrets.SERVER_HOST }}
        username: ${{ secrets.SERVER_USER }}
        key: ${{ secrets.SSH_PRIVATE_KEY }}
        port: ${{ secrets.SERVER_PORT }}
        script: |
          echo "ğŸ”§ Starting DEV deployment..."
          
          cd /home/deploy/apps/utassets-dev/
          
          # Pull latest changes
          echo "ğŸ“¥ Pulling latest code..."
          git pull origin develop
          
          # Frontend
          echo "ğŸ¨ Building frontend..."
          npm ci
          npm run build
          
          # Copy to web directory
          echo "ğŸ“¦ Copying files to /var/www..."
          sudo rm -rf /var/www/utassets-dev/*
          sudo cp -r build/* /var/www/utassets-dev/
          
          echo "âœ… DEV deployment completed!"
          echo "ğŸŒ https://dev.utassets.umtelkomd.net"